
## 기능 요구사항

### 1. 포인트 관리

- 포인트 충전: 사용자 포인트 충전 기능
- 잔액 조회: 현재 포인트 잔액 확인
- 포인트 사용: 주문 시 포인트 차감

**포인트 검증**

- 입력 검증: 충전/사용 금액 0 이하 시 valid 체크
- 잔액 검증: 사용 금액이 잔액보다 많은 경우 예외 발생


### 2. 상품 조회 시스템

- 인기 상품 조회: 최근 3일간 판매량 기준 TOP 5 상품 조회
- 필터링 조건: status=SUCCESS인 주문만 집계
- 상품 재고 관리: 주문 시 재고 확인 및 차감

### 3. 주문 및 결제 시스템

- 주문 상태 관리: CREATED → SUCCESS 또는 CANCELED
- 복합 검증: 잔액, 재고, 쿠폰 유효성 동시 검증
- 트랜잭션 처리: 검증 실패 시 주문 상태를 CANCELED로 변경
- 결제 처리: 포인트 차감, 재고 차감, 쿠폰 사용 처리를 순차 실행
- 멱등성 보장: txKey등  헤더를 통한 중복 주문 방지 및 동일 요청 재처리 지원

### 4. 쿠폰 시스템

- 선착순 발급: 현재 발급 수량 조회 후 제한 수량 내에서 발급
- 유효성 검증: 쿠폰 만료일 및 잔여 수량 확인
- 상태 관리: ISSUED → USED 상태 변경
- 주문 연동: 주문 시 쿠폰 적용 및 사용 처리


## 비기능 요구사항

### 데이터 일관성

- 동시성 제어: 생성/수정 요청 시 race condition 방지
- 트랜잭션 무결성: 주문 과정에서 부분 실패 시 rollback 처리
- 멱등성 구현: 동일한 txKey로 중복 요청 시 기존 결과 반환

### 외부 연동

- 데이터 플랫폼 연동: 주문 완료 시 외부 분석 플랫폼으로 데이터 전송 (Stub 사용)
- 실패 처리: 전송 실패 시 로그 기록 및 재시도 메커니즘